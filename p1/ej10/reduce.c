#include <stdio.h>
#include <stdlib.h>
#include <time.h>

double dwalltime();
double reduce(double array[512], int arrayLength)
{
    if (arrayLength > 2)
    {
        arrayLength = arrayLength / 2;
        for (int i = 0; i < arrayLength; i++)
        {
            array[i] = (array[i * 2] / array[i * 2 + 1]);
        }
        return reduce(array, arrayLength);
    }
    else
    {
        return array[0] / array[1];
    }
}

int main(int argc, char *argv[])
{
    int N = atoi(argv[1]);
    //double array[8] = {256, 2, 2, 4, 16, 2, 128, 64};
    double array[512] = {16384,512,16384,64,8,4,1024,2048,16,2048,64,256,8192,8192,256,4096,8192,32,2,16384,1024,32768,2048,32768,2,64,64,16384,64,128,8192,64,32768,32768,8,16384,2048,4,1024,256,256,32,8,1024,4,64,32,512,32,1024,128,256,1024,64,8192,128,32,2048,16384,2,1024,4,256,8192,8,512,1024,8,8192,8192,2048,4096,8,128,32,16,256,32,32,4,2,4096,32768,4,64,16384,32768,128,32768,4096,2,8192,16,128,32,16,8,4096,512,64,1024,4,2,32,128,16,2,32768,4,32768,2,512,256,4,4096,8,8192,2048,64,32768,16,8,4,128,2,4096,64,16384,512,32,64,16,16,128,16,4096,32,16,16,16384,16384,512,4096,512,128,64,1024,2048,32,2048,8,64,8,256,2048,2048,8192,128,4,2,128,16,32,2048,32768,16384,2,64,4,512,256,4,32768,128,128,64,8192,16384,2,32768,32768,8,2048,4,2,16384,4096,8192,64,4096,2048,16,32768,2048,64,1024,8,32,32768,16384,8192,512,64,512,512,32768,2,16,32,64,2,1024,4,8192,8,128,16384,16,8192,16,1024,1024,32,32768,2,4,16384,1024,128,2,2,8192,16384,32,2,4,128,4096,2,16384,1024,4096,8,4096,2,512,512,8,256,512,32768,256,2048,32768,2,16384,8192,2048,16,16384,32768,128,4096,16384,64,2048,16,512,8192,8192,32768,2048,2,1024,256,512,16,64,32,4,2048,4,512,2,32,64,1024,32768,128,4,4096,128,32,2048,16,8,32768,4096,4096,8192,16,4,4,2,2,8192,4,256,8192,128,4,8192,2048,2048,256,512,32768,128,256,8192,32,2048,128,8,4,32768,32768,2,4,128,512,16384,8,2048,8192,256,512,2048,128,16384,2,32768,8,2048,1024,512,4,16,128,128,32,256,2048,8192,64,128,8192,1024,32768,8192,1024,32768,4,4096,2,4096,256,1024,8192,64,4,256,16,2048,2,16,2,256,2048,4,4096,2048,128,4,1024,2048,32768,16384,2048,64,32768,32,128,256,32,8,16384,64,32,1024,32,16384,512,4,16384,32,8,128,2048,16,16384,8192,16384,128,2,8,16,16384,4,8192,4,16,1024,4096,2048,32,128,16384,1024,4,16,32,4,256,16,32768,32768,256,4096,2048,2,1024,16384,4096,2048,4,8192,4,8192,128,8192,8,512,8192,64,8,32,64,8192,32,1024,4,256,512,1024,128,256,8192,4,1024,128,256,128,16,2048,2048,32768,1024,8,4096,16,512,64,2,4096,256,64,16,256,8,256,512,2048,16,8192,32768,2,2,1024,4096,512,4,4096,4,1024,512,8192,16384,16,8,16384,8192};
    printf("resultado recursivo...\n");
    double timetick = dwalltime();
    printf("%f \n", reduce(array, 512));
    printf("Tiempo reduce recursivo en segundos %f \n", dwalltime() - timetick);

    return 0;
}

    /*****************************************************************/

#include <sys/time.h>

double dwalltime()
{
    double sec;
    struct timeval tv;

    gettimeofday(&tv, NULL);
    sec = tv.tv_sec + tv.tv_usec / 1000000.0;
    return sec;
}
